var CustomSelect=function($){var defaults={block:"custom-select",hideCallback:!1,includeValue:!1,keyboard:!0,modifier:!1,placeholder:!1,search:!1,showCallback:!1,transition:100,autocomplete:!1},CustomSelect=function(){function CustomSelect(select,options){this._$select=$(select),this._options=options,this._keydown=this._keydown.bind(this),this._dropup=this._dropup.bind(this),this._outside=this._outside.bind(this),this._options.autocomplete&&(this._options.search=!0,console.warn("Option `autocomplete` is deprecated since v1.3.0! Please, use `search` instead.")),this._init()}var _proto=CustomSelect.prototype;return _proto._init=function(){var _this=this;this._$element=$('<div class="'+this._options.block+'">\n           <button class="'+this._options.block+"__option "+this._options.block+'__option--value"></button>\n           <div class="'+this._options.block+'__dropdown"></div>\n         </div>'),this._$select.hide().after(this._$element),this._activeModifier=this._options.block+"--active",this._dropupModifier=this._options.block+"--dropup",this._$value=this._$element.find("."+this._options.block+"__option--value"),this._$dropdown=this._$element.find("."+this._options.block+"__dropdown"),this._options.modifier&&this._$element.addClass(this._options.modifier),this._$dropdown.html("").hide(),this._values=[],this._$selectOptions=this._$select.find("option"),$.each(this._$selectOptions,function(i,option){var el=$(option).text().trim();_this._values.push(el)}),this._options.placeholder&&(this._$select.find("[selected]").length?this._options.placeholder=!1:(this._$value.html(this._options.placeholder),this._$select.prop("selectedIndex",-1))),$.each(this._values,function(i,el){var cssClass=_this._$selectOptions.eq(i).attr("class"),$option=$('<button class="'+_this._options.block+'__option">'+el+"</button>");el===_this._$select.find(":selected").text().trim()?(_this._$value.text(el).addClass(cssClass).data("class",cssClass),(_this._options.includeValue||_this._options.placeholder)&&_this._$dropdown.append($option)):($option.addClass(cssClass),_this._$dropdown.append($option))}),this._$value.one("click",function(event){_this._show(event)}),this._$options=this._$dropdown.find("."+this._options.block+"__option"),this._$options.on("click",function(event){_this._select(event)}),this._options.search&&this._search()},_proto._show=function(event){var _this2=this;event.preventDefault(),this._dropup(),$(window).on("resize scroll",this._dropup),this._$element.addClass(this._activeModifier),this._$dropdown.slideDown(this._options.transition,function(){_this2._options.search&&_this2._$input.focus(),"function"==typeof _this2._options.showCallback&&_this2._options.showCallback.call(_this2._$element[0])});var outsideClickEvent="ontouchstart"in document.documentElement?"touchstart":"click";setTimeout(function(){$(window).on(outsideClickEvent,_this2._outside)},0),this._$value.one("click",function(event){event.preventDefault(),_this2._hide()}),this._options.keyboard&&(this._options.index=-1,$(window).on("keydown",this._keydown))},_proto._hide=function(){var _this3=this;this._$dropdown.slideUp(this._options.transition,function(){_this3._$element.removeClass(_this3._activeModifier).removeClass(_this3._dropupModifier),"function"==typeof _this3._options.hideCallback&&_this3._options.hideCallback.call(_this3._$element[0]),$(window).off("touchstart click",_this3._outside).off("resize scroll",_this3._dropup),_this3._$value.off("click").one("click",function(event){_this3._show(event)})}),this._options.keyboard&&(this._$options.blur(),$(window).off("keydown",this._keydown)),this._options.search&&(this._$options.show(),this._$input.val("").blur(),this._$wrap.scrollTop(0))},_proto._select=function(event){var _this4=this;event.preventDefault();var choice=$(event.currentTarget).text().trim(),values=this._values.slice();this._$value.text(choice).removeClass(this._$value.data("class")),this._$selectOptions.prop("selected",!1),$.each(values,function(i,el){_this4._options.includeValue||el!==choice||values.splice(i,1),$.each(_this4._$selectOptions,function(i,option){var $option=$(option);if($option.text().trim()===choice){var cssClass=$option.attr("class");$option.prop("selected",!0),_this4._$value.addClass(cssClass).data("class",cssClass)}})}),this._hide(),this._options.includeValue||(this._$options.length>values.length&&this._$options.eq(values.length).remove(),$.each(this._$options,function(i,option){var $option=$(option);$option.text(values[i]),$option.attr("class",_this4._options.block+"__option"),$.each(_this4._$selectOptions,function(){var $this=$(this);$this.text().trim()===values[i]&&$option.addClass($this.attr("class"))})})),void 0!==event.originalEvent&&this._$select.trigger("change")},_proto._search=function(){var _this5=this;this._$input=$('<input class="'+this._options.block+'__input" autocomplete="off">'),this._$dropdown.prepend(this._$input),this._$options.wrapAll('<div class="'+this._options.block+'__option-wrap"></div>'),this._$wrap=this._$element.find("."+this._options.block+"__option-wrap"),this._$input.on("focus",function(){_this5._options.index=-1,_this5._$wrap.scrollTop(0)}),this._$input.on("keyup",function(){var query=_this5._$input.val().trim();query.length?setTimeout(function(){query===_this5._$input.val().trim()&&$.each(_this5._$options,function(i,option){var $option=$(option),match=-1!==$option.text().trim().toLowerCase().indexOf(query.toLowerCase());$option.toggle(match)})},300):_this5._$options.show()})},_proto._dropup=function(){var bottom=this._$element[0].getBoundingClientRect().bottom,up=$(window).height()-bottom<this._$dropdown.height();this._$element.toggleClass(this._dropupModifier,up)},_proto._outside=function(event){var $target=$(event.target);$target.parents().is(this._$element)||$target.is(this._$element)||this._hide()},_proto._keydown=function(event){var visibleOptions=this._$options.filter(":visible");switch(event.keyCode){case 40:event.preventDefault();0!==this._$dropdown.find(visibleOptions).eq(this._options.index+1).length?this._options.index+=1:this._options.index=0,this._$dropdown.find(visibleOptions).eq(this._options.index).focus();break;case 38:event.preventDefault();0!==this._$dropdown.find(visibleOptions).eq(this._options.index-1).length&&this._options.index-1>=0?this._options.index-=1:this._options.index=this._$dropdown.find(visibleOptions).length-1,this._$dropdown.find(visibleOptions).eq(this._options.index).focus();break;case 13:case 32:if(!this._$input||!this._$input.is(":focus")){event.preventDefault();var $option=$("."+this._options.block+"__option:focus");$option.trigger("click"),$option.is(this._$value)||this._$select.trigger("change"),this._$value.focus()}break;case 27:event.preventDefault(),this._hide(),this._$value.focus()}},CustomSelect._jQueryPlugin=function(options){return this.each(function(){var _options=$.extend({},defaults),data=$(this).data("custom-select");"object"==typeof options&&$.extend(_options,options),data||(data=new CustomSelect(this,_options),$(this).data("custom-select",data))})},CustomSelect}();$.fn.customSelect=CustomSelect._jQueryPlugin,$.fn.customSelect.noConflict=function(){return $.fn.customSelect}}($);
//# sourceMappingURL=jquery.custom-select.min.js.map