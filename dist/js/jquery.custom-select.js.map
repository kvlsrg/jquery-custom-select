{"version":3,"file":"jquery.custom-select.js","names":["CustomSelect","$","defaults","block","hideCallback","includeValue","keyboard","modifier","placeholder","search","showCallback","transition","select","options","_$select","_options","_activeModifier","_dropupModifier","_optionSelectedModifier","_keydown","bind","_dropup","_outside","_init","reset","_$dropdown","hide","empty","_$value","off","_fill","_$element","after","addClass","find","_$values","_values","each","i","option","el","text","trim","push","length","html","prop","cssClass","eq","attr","$option","$selected","removeClass","data","removeData","toggleClass","is","append","_$options","_search","one","event","_show","on","_select","preventDefault","window","slideDown","_$input","focus","_scroll","call","setTimeout","document","_hide","index","val","blur","show","_$wrap","scrollTop","slideUp","top","position","height","outerHeight","center","choice","currentTarget","values","splice","last","remove","not","$this","originalEvent","trigger","prepend","wrapAll","query","toLowerCase","match","indexOf","toggle","bottom","getBoundingClientRect","up","$target","target","parents","$visible","filter","which","next","prev","add","_jQueryPlugin","config","fn","noConflict"],"sources":["../../jquery.custom-select.js"],"sourcesContent":["import $ from 'jquery';\n\n/*!\n * Custom Select jQuery Plugin\n */\n\nconst CustomSelect = (($) => {\n\n  const defaults = {\n    block: 'custom-select',\n    hideCallback: false,\n    includeValue: false,\n    keyboard: true,\n    modifier: false,\n    placeholder: false,\n    search: false,\n    showCallback: false,\n    transition: 0\n  };\n\n  class CustomSelect {\n\n    /**\n     * Custom Select\n     *\n     * @param {Element} select Original `<select>` DOM element to customize.\n     * @param {(Object|string)=} options Settings object or method name.\n     * @param {string=} options.block Custom select BEM block name.\n     * @param {Function=} options.hideCallback Fires after dropdown closes.\n     * @param {boolean=} options.includeValue Adds chosen value option to\n     *     dropdown. If enabled also cancels dropdown options rerender.\n     * @param {boolean=} options.keyboard Enables keyboard control.\n     * @param {string=} options.modifier Custom select block BEM modifier.\n     * @param {string=} options.placeholder Placeholder hint, can be an HTML\n     *     string (appears only if there is no explicitly selected options).\n     * @param {boolean=} options.search Adds input to filter options.\n     * @param {Function=} options.showCallback Fires after dropdown opens.\n     * @param {(number|string)=} options.transition jQuery slideUp/Down param.\n     */\n    constructor(select, options) {\n      this._$select = $(select);\n      this._options = {\n        ...defaults,\n        ...typeof options === 'object' ? options : {}\n      };\n\n      // Modifiers\n      this._activeModifier = `${this._options.block}--active`;\n      this._dropupModifier = `${this._options.block}--dropup`;\n      this._optionSelectedModifier = `${this._options.block}__option--selected`;\n\n      // Event handlers that can be removed\n      this._keydown = this._keydown.bind(this);\n      this._dropup = this._dropup.bind(this);\n      this._outside = this._outside.bind(this);\n\n      this._init();\n    }\n\n    /**\n     * Resets custom select options.\n     *\n     * @public\n     */\n    reset() {\n      this._$dropdown.hide().empty();\n      this._$value.off('click');\n\n      this._fill();\n    }\n\n    /**\n     * Renders initial state of custom select & sets\n     * options click event listeners.\n     *\n     * @private\n     */\n    _init() {\n      this._$element = $(\n        `<div class=\"${this._options.block}\">\n           <button class=\"${this._options.block}__option ${this._options.block}__option--value\" type=\"button\"></button>\n           <div class=\"${this._options.block}__dropdown\" style=\"display: none;\"></div>\n         </div>`\n      );\n\n      this._$select\n        .hide()\n        .after(this._$element);\n\n      if (this._options.modifier) {\n        this._$element.addClass(this._options.modifier);\n      }\n\n      this._$value = this._$element.find(`.${this._options.block}__option--value`);\n      this._$dropdown = this._$element.find(`.${this._options.block}__dropdown`);\n\n      this._fill();\n    }\n\n    /**\n     * Renders custom select options by original\n     * select element options.\n     *\n     * @private\n     */\n    _fill() {\n      this._$values = this._$select.find('option');\n      this._values = [];\n\n      let placeholder = this._options.placeholder;\n\n      $.each(this._$values, (i, option) => {\n        const el = $(option).text().trim();\n        this._values.push(el);\n      });\n\n      if (placeholder) {\n        // Check explicitly selected option\n        if (this._$select.find('[selected]').length) {\n          placeholder = false;\n        } else {\n          this._$value.html(placeholder);\n          // Set select value to null\n          this._$select.prop('selectedIndex', -1);\n        }\n      }\n\n      $.each(this._values, (i, el) => {\n        const cssClass = this._$values.eq(i).attr('class');\n        const $option = $(\n          `<button class=\"${this._options.block}__option\" type=\"button\">${el}</button>`\n        );\n        const $selected = this._$select.find(':selected');\n\n        if (this._$values.eq(i).attr('disabled')) {\n          $option.prop('disabled', true);\n        }\n\n        if ((!$selected.length && i === 0) || el === $selected.text().trim()) {\n          if (!placeholder) {\n            this._$value\n              .text(el)\n              .removeClass(this._$value.data('class')).removeData('class')\n              .addClass(cssClass).data('class', cssClass);\n          }\n\n          if (this._options.includeValue || placeholder) {\n            $option.addClass(cssClass);\n            $option.toggleClass(this._optionSelectedModifier, this._$values.eq(i).is('[selected]'));\n            this._$dropdown.append($option);\n          }\n        } else {\n          $option.addClass(cssClass);\n          this._$dropdown.append($option);\n        }\n      });\n\n      this._$options = this._$dropdown.find(`.${this._options.block}__option`);\n\n      if (this._options.search) {\n        this._search();\n      }\n\n      this._$value.one('click', event => {\n        this._show(event);\n      });\n\n      this._$value.prop('disabled', !this._$options.length);\n\n      this._$options.on('click', event => {\n        this._select(event);\n      });\n    }\n\n    /**\n     * Shows custom select dropdown & sets outside\n     * click listener to hide.\n     *\n     * @param {Object} event Value click jQuery event.\n     * @private\n     */\n    _show(event) {\n      event.preventDefault();\n\n      this._dropup();\n      $(window).on('resize scroll', this._dropup);\n\n      this._$element.addClass(this._activeModifier);\n\n      this._$dropdown.slideDown(this._options.transition, () => {\n        if (this._options.search) {\n          this._$input.focus();\n\n          if (this._options.includeValue) {\n            this._scroll();\n          }\n        }\n\n        // Open callback\n        if (typeof this._options.showCallback === 'function') {\n          this._options.showCallback.call(this._$element[0]);\n        }\n      });\n\n      setTimeout(() => {\n        $(document).on('touchstart click', this._outside);\n      }, 0);\n\n      this._$value.one('click', event => {\n        event.preventDefault();\n\n        this._hide();\n      });\n\n      if (this._options.keyboard) {\n        this._options.index = -1;\n        $(window).on('keydown', this._keydown);\n      }\n    }\n\n    /**\n     * Hides custom select dropdown & resets events\n     * listeners to initial.\n     *\n     * @private\n     */\n    _hide() {\n      if (this._options.search) {\n        this._$input.val('').blur();\n        this._$options.show();\n        this._$wrap.scrollTop(0);\n      }\n\n      this._$dropdown.slideUp(this._options.transition, () => {\n        this._$element\n          .removeClass(this._activeModifier)\n          .removeClass(this._dropupModifier);\n\n        // Close callback\n        if (typeof this._options.hideCallback === 'function') {\n          this._options.hideCallback.call(this._$element[0]);\n        }\n\n        this._$value\n          .off('click')\n          .one('click', event => {\n            this._show(event);\n          });\n        $(document).off('touchstart click', this._outside);\n        $(window).off('resize scroll', this._dropup);\n      });\n\n      if (this._options.keyboard) {\n        this._$options.blur();\n        $(window).off('keydown', this._keydown);\n      }\n    }\n\n    /**\n     * Centers chosen option in scrollable element\n     * of dropdown.\n     *\n     * @private\n     */\n    _scroll() {\n      $.each(this._$options, (i, option) => {\n        const $option = $(option);\n\n        if ($option.text() === this._$value.text()) {\n          const top = $option.position().top;\n          const height = this._$wrap.outerHeight();\n          const center = height / 2 - $option.outerHeight() / 2;\n\n          if (top > center) {\n            this._$wrap.scrollTop(top - center);\n          }\n\n          return false;\n        }\n      });\n    }\n\n    /**\n     * Changes value of custom select & `<select>`\n     * by chosen option.\n     *\n     * @param {Object} event Option click jQuery event.\n     * @private\n     */\n    _select(event) {\n      event.preventDefault();\n\n      const choice = $(event.currentTarget).text().trim();\n      const values = [...this._values];\n\n      this._$value\n        .text(choice)\n        .removeClass(this._$value.data('class'));\n      this._$values.prop('selected', false);\n\n      $.each(values, (i, el) => {\n        if (!this._options.includeValue && el === choice) {\n          values.splice(i, 1);\n        }\n\n        $.each(this._$values, (i, option) => {\n          const $option = $(option);\n          if ($option.text().trim() === choice) {\n            const cssClass = $option.attr('class');\n\n            $option.prop('selected', true);\n            this._$value.addClass(cssClass).data('class', cssClass);\n          }\n        });\n      });\n\n      this._hide();\n\n      if (!this._options.includeValue) {\n        // Update dropdown options content\n        if (this._$options.length > values.length) {\n          const last = this._$options.eq(values.length);\n\n          last.remove();\n          this._$options = this._$options.not(last);\n\n          if (!this._$options.length) {\n            this._$value.prop('disabled', true);\n          }\n        }\n\n        $.each(this._$options, (i, option) => {\n          const $option = $(option);\n          $option.text(values[i]);\n\n          // Reset option class\n          $option.attr('class', `${this._options.block}__option`);\n\n          $.each(this._$values, function () {\n            const $this = $(this);\n            if ($this.text().trim() === values[i]) {\n              $option.addClass($this.attr('class'));\n              $option.prop('disabled', $this.prop('disabled'));\n            }\n          });\n        });\n      } else {\n        // Select chosen option\n        this._$options.removeClass(this._optionSelectedModifier);\n\n        $.each(this._$options, (i, option) => {\n          const $option = $(option);\n\n          if ($option.text().trim() === choice) {\n            $option.addClass(this._optionSelectedModifier);\n\n            return false;\n          }\n        });\n      }\n\n      if (typeof event.originalEvent !== 'undefined') {\n        this._$select.trigger('change');\n      }\n    }\n\n    /**\n     * Wraps options by wrap element, adds search\n     * input to dropdown.\n     *\n     * @private\n     */\n    _search() {\n      this._$input = $(`<input class=\"${this._options.block}__input\" autocomplete=\"off\">`);\n      this._$dropdown.prepend(this._$input);\n\n      // Add scrollable wrap\n      this._$options.wrapAll(`<div class=\"${this._options.block}__option-wrap\"></div>`);\n      this._$wrap = this._$element.find(`.${this._options.block}__option-wrap`);\n\n      this._$input.on('focus', () => {\n        this._options.index = -1;\n      });\n\n      this._$input.on('keyup', () => {\n        const query = this._$input.val().trim();\n\n        if (query.length) {\n          this._$wrap.scrollTop(0);\n\n          setTimeout(() => {\n            if (query === this._$input.val().trim()) {\n              $.each(this._$options, (i, option) => {\n                const $option = $(option);\n                const text = $option.text().trim().toLowerCase();\n                const match = text.indexOf(query.toLowerCase()) !== -1;\n\n                $option.toggle(match);\n              });\n            }\n          }, 300);\n        } else {\n          this._$options.show();\n        }\n      });\n    }\n\n    /**\n     * Toggles custom select dropup modifier based\n     * on space for dropdown below.\n     *\n     * @private\n     */\n    _dropup() {\n      const bottom = this._$element[0].getBoundingClientRect().bottom;\n      const up = $(window).height() - bottom < this._$dropdown.height();\n\n      this._$element.toggleClass(this._dropupModifier, up);\n    }\n\n    /**\n     * Hides dropdown if target of event (e.g. click\n     * on `$window`) is not custom select.\n     *\n     * @param {Object} event Outside \"click\" jQuery event.\n     * @private\n     */\n    _outside(event) {\n      const $target = $(event.target);\n      if (!$target.parents().is(this._$element) && !$target.is(this._$element)) {\n        this._hide();\n      }\n    }\n\n    /**\n     * Controls navigation from keyboard by custom\n     * select options.\n     *\n     * @param {Object} event Keydown jQuery event.\n     * @private\n     */\n    _keydown(event) {\n      const $visible = this._$options.filter(':visible').not('[disabled]');\n\n      switch (event.which) {\n        // Down\n        case 40:\n          event.preventDefault();\n\n          const next = $visible.eq(this._options.index + 1).length;\n          if (next) {\n            this._options.index += 1;\n          } else {\n            this._options.index = 0;\n          }\n\n          $visible.eq(this._options.index).focus();\n          break;\n\n        // Up\n        case 38:\n          event.preventDefault();\n\n          const prev = $visible.eq(this._options.index - 1).length;\n          if (prev && this._options.index - 1 >= 0) {\n            this._options.index -= 1;\n          } else {\n            this._options.index = $visible.length - 1;\n          }\n\n          $visible.eq(this._options.index).focus();\n          break;\n\n        // Enter\n        case 13:\n\n        // Space\n        case 32:\n          if (!this._$input || !this._$input.is(':focus')) {\n            event.preventDefault();\n\n            const $option = this._$options.add(this._$value).filter(':focus');\n            $option.trigger('click');\n\n            if (!$option.is(this._$value)) {\n              this._$select.trigger('change');\n            }\n            this._$value.focus();\n          }\n          break;\n\n        // Esc\n        case 27:\n          event.preventDefault();\n\n          this._hide();\n          this._$value.focus();\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    /**\n     * Creates jQuery plugin function.\n     *\n     * @param {(Object|string)=} config Options or method.\n     * @returns {Function} jQuery plugin.\n     */\n    static _jQueryPlugin(config) {\n      return this.each(function () {\n        const $this = $(this);\n        let data = $this.data('custom-select');\n\n        if (!data) {\n          if (typeof config !== 'string') {\n            data = new CustomSelect(this, config);\n            $this.data('custom-select', data);\n          }\n        } else {\n          if (config === 'reset') {\n            data.reset();\n          }\n        }\n      });\n    }\n  }\n\n  $.fn['customSelect'] = CustomSelect._jQueryPlugin;\n  $.fn['customSelect'].noConflict = () => $.fn['customSelect'];\n\n  return CustomSelect;\n\n})($);\n\nexport default CustomSelect;\n"],"mappings":"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"}